<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Knowledge Development Stationery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .riyal-symbol { font-family: 'Arial', sans-serif; font-weight: bold; }
        :root { --store-yellow: #F4D03F; --store-blue: #4A90E2; }
        .btn-primary { @apply bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors; }
        .btn-secondary { @apply bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors; }
        .btn-danger { @apply bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors; }
        .tab-button { @apply py-4 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 font-medium text-sm transition-colors; }
        .tab-button.active { @apply border-blue-500 text-blue-600; }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-900">Admin Panel</h1>
                    <span class="ml-4 text-sm text-gray-500">Knowledge Development Stationery</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="index.html" class="text-blue-600 hover:text-blue-800">Back to Store</a>
                    <button onclick="logout()" class="btn-secondary">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Dashboard Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 text-blue-600">
                        <i class="fas fa-shopping-cart text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Total Orders</p>
                        <p class="text-2xl font-semibold text-gray-900" id="total-orders">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 text-green-600">
                        <i class="fas fa-dollar-sign text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Revenue</p>
                        <p class="text-2xl font-semibold text-gray-900" id="total-revenue">0.00 <span class="riyal-symbol">ï·¼</span></p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-yellow-100 text-yellow-600" style="background-color: #FEF3C7; color: var(--store-yellow);">
                        <i class="fas fa-box text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Products</p>
                        <p class="text-2xl font-semibold text-gray-900" id="total-products">0</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-100 text-purple-600">
                        <i class="fas fa-users text-xl"></i>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600">Customers</p>
                        <p class="text-2xl font-semibold text-gray-900" id="total-customers">0</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8 px-6">
                    <button onclick="showTab('products')" class="tab-button active">
                        <i class="fas fa-box mr-2"></i>Products
                    </button>
                    <button onclick="showTab('categories')" class="tab-button">
                        <i class="fas fa-tags mr-2"></i>Categories
                    </button>
                    <button onclick="showTab('orders')" class="tab-button">
                        <i class="fas fa-list mr-2"></i>Orders
                    </button>
                </nav>
            </div>

            <!-- Products Tab -->
            <div id="products-tab" class="tab-content p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-semibold text-gray-900">Product Management</h2>
                    <button onclick="addNewProduct()" class="btn-primary">
                        <i class="fas fa-plus mr-2"></i>Add Product
                    </button>
                </div>
                
                <div id="products-list" class="space-y-4">
                    <!-- Products will be loaded here -->
                </div>
            </div>

            <!-- Categories Tab -->
            <div id="categories-tab" class="tab-content p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-semibold text-gray-900">Category Management</h2>
                    <button onclick="addNewCategory()" class="btn-primary">
                        <i class="fas fa-plus mr-2"></i>Add Category
                    </button>
                </div>
                
                <div id="categories-list" class="space-y-4">
                    <!-- Categories will be loaded here -->
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders-tab" class="tab-content p-6 hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-lg font-semibold text-gray-900">Order Management</h2>
                </div>
                
                <div id="orders-list" class="space-y-4">
                    <!-- Orders will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let products = [];
        let categories = [];
        let orders = [];
        let currentTab = 'products';

        // Initialize admin panel
        function init() {
            loadDataFromStorage();
            updateDashboard();
            showTab('products');
        }

        // Load all data from localStorage
        function loadDataFromStorage() {
            // Load products
            const storedProducts = localStorage.getItem('stationeryProducts');
            if (storedProducts) {
                products = JSON.parse(storedProducts);
            }

            // Load categories
            const storedCategories = localStorage.getItem('stationeryCategories');
            if (storedCategories) {
                categories = JSON.parse(storedCategories);
            }

            // Load orders
            const storedOrders = localStorage.getItem('stationeryOrders');
            if (storedOrders) {
                orders = JSON.parse(storedOrders);
            }
        }

        // Save data to localStorage
        function saveDataToStorage() {
            localStorage.setItem('stationeryProducts', JSON.stringify(products));
            localStorage.setItem('stationeryCategories', JSON.stringify(categories));
            localStorage.setItem('stationeryOrders', JSON.stringify(orders));
        }

        // Tab switching
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Add active class to selected button
            event.target.classList.add('active');
            
            currentTab = tabName;
            
            // Load tab content
            switch(tabName) {
                case 'products':
                    loadProducts();
                    break;
                case 'categories':
                    loadCategories();
                    break;
                case 'orders':
                    loadOrders();
                    break;
            }
        }

        // Load products
        function loadProducts() {
            const productsList = document.getElementById('products-list');
            productsList.innerHTML = '';

            if (products.length === 0) {
                productsList.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-box-open text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Products</h3>
                        <p class="text-gray-500">Add your first product to get started</p>
                    </div>
                `;
                return;
            }

            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white border rounded-lg p-6 shadow-sm';
                productCard.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-lg">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900">${product.name}</h3>
                                <p class="text-sm text-gray-500">${product.nameAr}</p>
                                <p class="text-sm text-gray-600">${product.category} â¢ Stock: ${product.stock}</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <p class="text-lg font-semibold text-gray-900">${product.price.toFixed(2)} <span class="riyal-symbol">ï·¼</span></p>
                                <p class="text-sm text-gray-500">${product.stock} in stock</p>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="editProduct(${product.id})" class="btn-secondary text-sm">
                                    <i class="fas fa-edit mr-1"></i>Edit
                                </button>
                                <button onclick="deleteProduct(${product.id})" class="btn-danger text-sm">
                                    <i class="fas fa-trash mr-1"></i>Delete
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                productsList.appendChild(productCard);
            });
        }

        // Load categories
        function loadCategories() {
            const categoriesList = document.getElementById('categories-list');
            categoriesList.innerHTML = '';

            if (categories.length === 0) {
                categoriesList.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-tags text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Categories</h3>
                        <p class="text-gray-500">Add your first category to organize products</p>
                    </div>
                `;
                return;
            }

            categories.forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.className = 'bg-white border rounded-lg p-6 shadow-sm';
                categoryCard.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">${category.name}</h3>
                            <p class="text-sm text-gray-500">${category.nameAr}</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="editCategory(${category.id})" class="btn-secondary text-sm">
                                <i class="fas fa-edit mr-1"></i>Edit
                            </button>
                            <button onclick="deleteCategory(${category.id})" class="btn-danger text-sm">
                                <i class="fas fa-trash mr-1"></i>Delete
                            </button>
                        </div>
                    </div>
                `;
                categoriesList.appendChild(categoryCard);
            });
        }

        // Load orders
        function loadOrders() {
            const ordersList = document.getElementById('orders-list');
            ordersList.innerHTML = '';

            if (orders.length === 0) {
                ordersList.innerHTML = `
                    <div class="text-center py-12">
                        <i class="fas fa-shopping-cart text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No Orders</h3>
                        <p class="text-gray-500">Orders will appear here when customers make purchases</p>
                    </div>
                `;
                return;
            }

            orders.forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'bg-white border rounded-lg p-6 shadow-sm';
                orderCard.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900">Order #${order.id}</h3>
                            <p class="text-sm text-gray-500">${order.customer} â¢ ${order.date}</p>
                            <p class="text-sm text-gray-600">${order.items.length} items â¢ ${order.total.toFixed(2)} <span class="riyal-symbol">ï·¼</span></p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <span class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800">
                                ${order.status.replace('_', ' ')}
                            </span>
                            <button onclick="viewOrder(${order.id})" class="btn-secondary text-sm">
                                <i class="fas fa-eye mr-1"></i>View
                            </button>
                        </div>
                    </div>
                `;
                ordersList.appendChild(orderCard);
            });
        }

        // Add new product
        function addNewProduct() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">Add New Product</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveNewProduct(event)">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Product Name (English)</label>
                                    <input type="text" name="name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Product Name (Arabic)</label>
                                    <input type="text" name="nameAr" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Price (SAR)</label>
                                    <input type="number" name="price" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Stock Quantity</label>
                                    <input type="number" name="stock" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                                    <select name="category" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                        <option value="">Select Category</option>
                                        ${categories.map(cat => `<option value="${cat.name}">${cat.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rating</label>
                                    <input type="number" name="rating" min="0" max="5" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Image URL</label>
                                <input type="url" name="image" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/image.jpg">
                            </div>
                            
                            <div class="flex justify-end space-x-3">
                                <button type="button" onclick="this.closest('.fixed').remove()" class="btn-secondary">Cancel</button>
                                <button type="submit" class="btn-primary">Add Product</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Save new product
        function saveNewProduct(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            const newProduct = {
                id: products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1,
                name: formData.get('name'),
                nameAr: formData.get('nameAr'),
                price: parseFloat(formData.get('price')),
                stock: parseInt(formData.get('stock')),
                category: formData.get('category'),
                rating: parseFloat(formData.get('rating')) || 0,
                image: formData.get('image') || 'https://via.placeholder.com/300x300?text=No+Image'
            };
            
            products.push(newProduct);
            saveDataToStorage();
            loadProducts();
            updateDashboard();
            
            event.target.closest('.fixed').remove();
            showNotification('Product added successfully!', 'success');
        }

        // Add new category
        function addNewCategory() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-lg w-full">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">Add New Category</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveNewCategory(event)">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category Name (English)</label>
                                <input type="text" name="name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category Name (Arabic)</label>
                                <input type="text" name="nameAr" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div class="flex justify-end space-x-3">
                                <button type="button" onclick="this.closest('.fixed').remove()" class="btn-secondary">Cancel</button>
                                <button type="submit" class="btn-primary">Add Category</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Save new category
        function saveNewCategory(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            const newCategory = {
                id: categories.length > 0 ? Math.max(...categories.map(c => c.id)) + 1 : 1,
                name: formData.get('name'),
                nameAr: formData.get('nameAr')
            };
            
            categories.push(newCategory);
            saveDataToStorage();
            loadCategories();
            
            event.target.closest('.fixed').remove();
            showNotification('Category added successfully!', 'success');
        }

        // Edit product
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">Edit Product</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveProductChanges(event, ${productId})">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Product Name (English)</label>
                                    <input type="text" name="name" value="${product.name}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Product Name (Arabic)</label>
                                    <input type="text" name="nameAr" value="${product.nameAr}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Price (SAR)</label>
                                    <input type="number" name="price" step="0.01" value="${product.price}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Stock Quantity</label>
                                    <input type="number" name="stock" value="${product.stock}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                                    <select name="category" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                        <option value="">Select Category</option>
                                        ${categories.map(cat => `<option value="${cat.name}" ${cat.name === product.category ? 'selected' : ''}>${cat.name}</option>`).join('')}
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rating</label>
                                    <input type="number" name="rating" min="0" max="5" step="0.1" value="${product.rating}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Image URL</label>
                                <input type="url" name="image" value="${product.image}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            
                            <div class="flex justify-end space-x-3">
                                <button type="button" onclick="this.closest('.fixed').remove()" class="btn-secondary">Cancel</button>
                                <button type="submit" class="btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Save product changes
        function saveProductChanges(event, productId) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            const productIndex = products.findIndex(p => p.id === productId);
            if (productIndex === -1) return;
            
            products[productIndex] = {
                ...products[productIndex],
                name: formData.get('name'),
                nameAr: formData.get('nameAr'),
                price: parseFloat(formData.get('price')),
                stock: parseInt(formData.get('stock')),
                category: formData.get('category'),
                rating: parseFloat(formData.get('rating')) || 0,
                image: formData.get('image') || 'https://via.placeholder.com/300x300?text=No+Image'
            };
            
            saveDataToStorage();
            loadProducts();
            updateDashboard();
            
            event.target.closest('.fixed').remove();
            showNotification('Product updated successfully!', 'success');
        }

        // Delete product
        function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product?')) {
                products = products.filter(p => p.id !== productId);
                saveDataToStorage();
                loadProducts();
                updateDashboard();
                showNotification('Product deleted successfully!', 'success');
            }
        }

        // Edit category
        function editCategory(categoryId) {
            const category = categories.find(c => c.id === categoryId);
            if (!category) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-lg w-full">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">Edit Category</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <form onsubmit="saveCategoryChanges(event, ${categoryId})">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category Name (English)</label>
                                <input type="text" name="name" value="${category.name}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Category Name (Arabic)</label>
                                <input type="text" name="nameAr" value="${category.nameAr}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div class="flex justify-end space-x-3">
                                <button type="button" onclick="this.closest('.fixed').remove()" class="btn-secondary">Cancel</button>
                                <button type="submit" class="btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Save category changes
        function saveCategoryChanges(event, categoryId) {
            event.preventDefault();
            const formData = new FormData(event.target);
            
            const categoryIndex = categories.findIndex(c => c.id === categoryId);
            if (categoryIndex === -1) return;
            
            categories[categoryIndex] = {
                ...categories[categoryIndex],
                name: formData.get('name'),
                nameAr: formData.get('nameAr')
            };
            
            saveDataToStorage();
            loadCategories();
            
            event.target.closest('.fixed').remove();
            showNotification('Category updated successfully!', 'success');
        }

        // Delete category
        function deleteCategory(categoryId) {
            if (confirm('Are you sure you want to delete this category?')) {
                categories = categories.filter(c => c.id !== categoryId);
                saveDataToStorage();
                loadCategories();
                showNotification('Category deleted successfully!', 'success');
            }
        }

        // View order
        function viewOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-xl font-semibold">Order #${order.id}</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Customer</label>
                                    <p class="text-gray-900">${order.customer}</p>
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-700">Status</label>
                                    <p class="text-gray-900 capitalize">${order.status.replace('_', ' ')}</p>
                                </div>
                            </div>
                            
                            <div>
                                <label class="text-sm font-medium text-gray-700">Order Items</label>
                                <div class="mt-2 space-y-2">
                                    ${order.items.map(item => `
                                        <div class="flex justify-between items-center p-3 bg-gray-50 rounded">
                                            <span>${item.name} Ã ${item.quantity}</span>
                                            <span class="font-medium">${(item.price * item.quantity).toFixed(2)} <span class="riyal-symbol">ï·¼</span></span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="border-t pt-4">
                                <div class="flex justify-between text-lg font-semibold">
                                    <span>Total:</span>
                                    <span>${order.total.toFixed(2)} <span class="riyal-symbol">ï·¼</span></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-3 mt-6">
                            <button onclick="this.closest('.fixed').remove()" class="btn-secondary">Close</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Update dashboard
        function updateDashboard() {
            document.getElementById('total-orders').textContent = orders.length;
            document.getElementById('total-revenue').textContent = orders.reduce((sum, order) => sum + order.total, 0).toFixed(2) + ' ï·¼';
            document.getElementById('total-products').textContent = products.length;
            document.getElementById('total-customers').textContent = new Set(orders.map(order => order.customer)).size;
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'success' ? 'bg-green-500 text-white' :
                type === 'error' ? 'bg-red-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Logout
        function logout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminLoginTime');
            window.location.href = 'admin-login.html';
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
